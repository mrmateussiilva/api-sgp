<style>
  .template-page {
    width: 187mm;
    height: 280mm; /* 140mm * 2 itens = 280mm */
    max-height: 280mm;
    padding: 0;
    box-sizing: border-box;
    background: white;
    overflow: hidden !important;
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    page-break-after: always !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    display: flex;
    flex-direction: column;
    gap: 0;
    margin: 0;
  }

  .item-container {
    width: 100%;
    height: 140mm; /* Altura de cada item */
    max-height: 140mm;
    min-height: 140mm;
    padding: 2mm;
    border: none;
    border-bottom: 1px solid #ddd;
    border-radius: 0;
    box-sizing: border-box;
    background: #fafafa;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    flex-shrink: 0;
    margin: 0;
  }

  .item-container:last-child {
    border-bottom: none;
  }

  .header-section {
    display: flex;
    align-items: flex-start;
    margin-bottom: 4mm;
    border-bottom: 1px solid #ddd;
    padding-bottom: 2mm;
    flex-shrink: 0;
  }

  .id-box {
    background: #1a1a1a;
    color: white;
    padding: 3mm 5mm;
    font-weight: bold;
    font-size: 14pt;
    margin-right: 4mm;
    min-width: 25mm;
    text-align: center;
    border-radius: 2mm;
  }

  .cliente-info {
    flex: 1;
    font-size: 9pt;
  }

  .cliente-nome {
    font-weight: bold;
    font-size: 10pt;
    margin-bottom: 1mm;
  }

  .cliente-detalhes {
    color: #666;
    font-size: 8pt;
  }

  .content-wrapper {
    display: flex;
    gap: 3mm;
    flex: 1;
    overflow: hidden;
  }

  .left-column {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .right-column {
    width: 55mm;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
  }

  .section-title {
    font-weight: bold;
    font-size: 8pt;
    text-transform: uppercase;
    margin-bottom: 2mm;
    color: #333;
    border-bottom: 1px solid #ddd;
    padding-bottom: 1mm;
  }

  .section-content {
    flex: 1;
    font-size: 8pt;
    line-height: 1.4;
    overflow: visible;
    max-height: none;
  }

  .spec-item {
    margin-bottom: 0.5mm;
    font-size: 8pt;
    line-height: 1.3;
  }

  .spec-item.hidden-empty {
    display: none;
  }

  .image-container {
    width: 100%;
    height: 80mm;
    border: 1px solid #ddd;
    border-radius: 2mm;
    overflow: hidden;
    background: #f9f9f9;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .image-container img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  .observacao-box {
    margin-top: 2mm;
    padding: 2mm;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 2mm;
    font-size: 8pt;
    min-height: 15mm;
  }

  @media print {
    .template-page {
      page-break-inside: avoid !important;
    }
    .item-container {
      page-break-inside: avoid !important;
    }
  }
</style>

<div class="template-page" data-tipo-producao="{{tipo_producao}}">
  <div class="item-container">
    <div class="header-section">
      <div class="id-box">{{numero}}</div>
      <div class="cliente-info">
        <div class="cliente-nome">{{cliente}}</div>
        <div class="cliente-detalhes">
          {{telefone_cliente}}{{#if telefone_cliente}}{{#if cidade_estado}} • {{/if}}{{/if}}{{cidade_estado}}
        </div>
      </div>
    </div>

    <div class="content-wrapper">
      <div class="left-column">
        <div class="section-title">DESCRIÇÃO</div>
        <div class="section-content">
          <div class="spec-item">{{descricao}}</div>
          <div class="spec-item">Dimensões: {{dimensoes}}</div>
          <div class="spec-item">Quantidade: {{quantity}}</div>
        </div>

        <div class="section-title especificacoes-title">ESPECIFICAÇÕES TÉCNICAS</div>
        <div class="section-content especificacoes-content" data-tipo-producao="{{tipo_producao}}">
          
          <!-- Campos comuns para todos os tipos -->
          <div class="spec-item">Material: {{material}}</div>
          <div class="spec-item">Emenda: {{emenda_label}}</div>
          <div class="spec-item" data-show-if="emenda_qtd">Qtd. Emendas: {{emenda_qtd}}</div>

          <!-- Campos específicos para PAINEL/TECIDO -->
          <div class="spec-item spec-painel spec-tecido" data-tipo-producao="painel,generica">
            <div>• Acabamentos: {{acabamentos_painel}}</div>
            <div>• Overloque: {{overloque}}</div>
            <div>• Elástico: {{elastico}}</div>
            <div>• Ilhós: {{ilhos_resumo}}</div>
            <div>• Cordinha: {{cordinha_resumo}}</div>
            <div data-show-if="quantidade_paineis">• Qtd. Painéis: {{quantidade_paineis}}</div>
          </div>

          <!-- Campos específicos para TOTEM -->
          <div class="spec-item spec-totem" data-tipo-producao="totem">
            <div>• Acabamento: {{acabamento_totem_resumo}}</div>
            <div data-show-if="acabamento_totem_outro">• Observação: {{acabamento_totem_outro}}</div>
            <div data-show-if="quantidade_totem">• Qtd. Totens: {{quantidade_totem}}</div>
          </div>

          <!-- Campos específicos para LONA -->
          <div class="spec-item spec-lona" data-tipo-producao="lona">
            <div data-show-if="acabamento_lona">• Acabamento Lona: {{acabamento_lona}}</div>
            <div data-show-if="quantidade_lona">• Qtd. Lonas: {{quantidade_lona}}</div>
            <div data-show-if="quantidade_ilhos">• Ilhós: {{quantidade_ilhos}}</div>
            <div data-show-if="espaco_ilhos">• Espaçamento Ilhós: {{espaco_ilhos}}</div>
            <div data-show-if="quantidade_cordinha">• Cordinha: {{quantidade_cordinha}}</div>
            <div data-show-if="espaco_cordinha">• Espaçamento Cordinha: {{espaco_cordinha}}</div>
          </div>

          <!-- Campos específicos para ADESIVO -->
          <div class="spec-item spec-adesivo" data-tipo-producao="adesivo">
            <div data-show-if="tipo_adesivo">• Tipo Adesivo: {{tipo_adesivo}}</div>
            <div data-show-if="quantidade_adesivo">• Qtd. Adesivos: {{quantidade_adesivo}}</div>
          </div>

          <!-- Campos genéricos -->
          <div class="spec-item" data-show-if="observacao_item">Observação: {{observacao_item}}</div>
          <div class="spec-item" data-show-if="designer">Designer: {{designer}}</div>
          <div class="spec-item" data-show-if="vendedor">Vendedor: {{vendedor}}</div>
        </div>
      </div>

      <div class="right-column">
        <div class="section-title">VISUAL DO ITEM</div>
        <div class="image-container">
          <img src="{{imagem}}" alt="Item" onerror="this.style.display='none';" />
        </div>
        <div class="observacao-box" data-show-if="legenda_imagem">
          {{legenda_imagem}}
        </div>
      </div>
    </div>
  </div>
</div>
