<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Ficha de Produ√ß√£o</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @page {
            size: A4;
            margin: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            color: #000;
            background: #fff;
        }

        /* RESET IMPRESS√ÉO */
        @media print {
            body {
                margin: 0;
            }
        }

        /* FICHA - 210mm x 135mm (Total 270mm < 297mm A4) */
        /* Margem de seguran√ßa de ~27mm para evitar quebra errada */
        .ficha {
            width: 210mm;
            height: 135mm;
            position: relative;
            page-break-inside: avoid;
            padding: 5mm;
            overflow: hidden;
            border-bottom: 2px dashed #999;
            margin-bottom: 0;
            display: block;
            /* Garante bloco */
        }

        /* HEADER LIMPO - 8mm fixo com fundo sutil */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 8mm;
            border-bottom: 1px solid #ccc;
            background-color: #f9f9f9;
            margin-bottom: 3mm;
            padding: 0 4mm;
            /* Padding lateral */
            font-size: 10px;
            overflow: hidden;
        }

        .header-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .h-label {
            font-weight: 700;
            text-transform: uppercase;
            color: #555;
            font-size: 9px;
        }

        .h-value {
            font-weight: 600;
            color: #000;
            text-transform: uppercase;
        }

        /* PRIORIDADE EM FORMATO DE PILL */
        .prioridade-tag {
            font-weight: 700;
            text-transform: uppercase;
            padding: 1px 6px;
            border-radius: 4px;
            font-size: 9px;
        }

        .prioridade-alta-tag {
            color: #dc3545;
            background: #fff0f0;
            border: 1px solid #ffcccc;
        }

        .prioridade-media-tag {
            color: #856404;
            background: #fff3cd;
            border: 1px solid #ffeeba;
        }

        .prioridade-baixa-tag {
            color: #155724;
            background: #d4edda;
            border: 1px solid #c3e6cb;
        }

        /* SE√á√ÉO PRINCIPAL - 110mm fixo */
        .main-section {
            display: flex;
            gap: 4mm;
            height: 110mm;
            overflow: hidden;
        }

        /* COLUNA ESQUERDA - 90mm fixo */
        .col-left {
            flex: 0 0 90mm;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* PEDIDO E CLIENTE - Mais limpo */
        .pedido-box {
            border-bottom: 1px dashed #ddd;
            padding-bottom: 2mm;
            margin-bottom: 2mm;
            flex-shrink: 0;
            height: 25mm;
            overflow: hidden;
        }

        .pedido-numero {
            font-size: 28px;
            font-weight: 800;
            line-height: 0.9;
            margin-bottom: 2px;
            color: #000;
            white-space: nowrap;
            letter-spacing: -0.5px;
        }

        .badge-reposicao {
            display: inline-block;
            background: #ff6b35;
            color: #fff;
            padding: 2px 6px;
            font-size: 8px;
            font-weight: 700;
            border-radius: 4px;
            text-transform: uppercase;
            margin-left: 6px;
            vertical-align: middle;
            letter-spacing: 0.5px;
        }

        .cliente-nome {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 3px;
            line-height: 1.1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #333;
        }

        .cliente-info {
            font-size: 9px;
            color: #666;
            display: flex;
            align-items: center;
        }

        .tipo-badge {
            display: inline-block;
            padding: 2px 6px;
            font-weight: 700;
            font-size: 8px;
            text-transform: uppercase;
            border-radius: 4px;
            margin-top: 2px;
        }

        .tipo-badge.painel {
            color: #004085;
            background-color: #cce5ff;
            border: 1px solid #b8daff;
        }

        .tipo-badge.lona {
            color: #155724;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
        }

        .tipo-badge.totem {
            color: #380d75;
            background-color: #e0cffc;
            border: 1px solid #d6bbfb;
        }

        .tipo-badge.adesivo {
            color: #856404;
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
        }

        /* CONTE√öDO ESQUERDA - Restante da altura */
        .left-content {
            flex: 1;
            overflow: hidden;
        }

        /* PRODUTO */
        .produto-nome {
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 2mm;
            line-height: 1.1;
            max-height: 10mm;
            overflow: hidden;
            color: #222;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2mm;
            margin-bottom: 2mm;
            padding: 2mm 3mm;
            background: #f8f9fa;
            border: 1px solid #eee;
            border-radius: 4px;
            height: 14mm;
            overflow: hidden;
        }

        .info-label {
            font-size: 7px;
            font-weight: 700;
            text-transform: uppercase;
            color: #888;
            margin-bottom: 1px;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 11px;
            font-weight: 700;
            color: #000;
        }

        .qty {
            font-size: 18px;
            color: #d32f2f;
        }

        /* FICHA T√âCNICA */
        .tech-section {
            margin-bottom: 2mm;
            font-size: 9px;
            height: 10mm;
            overflow: hidden;
            border-left: 2px solid #eee;
            padding-left: 3mm;
        }

        .tech-title {
            font-size: 8px;
            font-weight: 700;
            text-transform: uppercase;
            color: #aaa;
            margin-bottom: 1px;
        }

        .tech-item {
            margin-bottom: 1px;
            color: #333;
        }

        .tech-label {
            font-weight: 700;
            color: #555;
        }

        .specs {
            font-size: 9px;
            line-height: 1.4;
            height: 30mm;
            /* Aumentado para mostrar mais specs */
            overflow: hidden;
        }

        .specs li {
            list-style: none;
            padding-left: 8px;
            position: relative;
            margin-bottom: 1.5mm;
        }

        .specs li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            font-weight: 700;
        }

        .obs-container {
            height: 15mm;
            /* Ajustado para balancear com specs */
            overflow: hidden;
            margin-top: 2mm;
        }

        .obs {
            border-left: 3px solid #ff6b35;
            padding: 2mm;
            background: #fff5f0;
            font-size: 8px;
            line-height: 1.2;
            height: 100%;
        }

        .obs.pedido {
            border-left-color: #0066cc;
            background: #e6f2ff;
        }

        .obs-title {
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 1mm;
        }

        /* COLUNA DIREITA - IMAGEM (55%) */
        .col-right {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 100%;
            /* For√ßa altura do pai */
        }

        .img-title {
            font-size: 8px;
            font-weight: 600;
            text-transform: uppercase;
            color: #666;
            text-align: center;
            margin-bottom: 2mm;
            height: 4mm;
        }

        .img-box {
            flex: 1;
            border: 2px solid #ddd;
            border-radius: 3px;
            background: #fafafa;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            max-height: 100mm;
            /* Reduzido proporcionalmente */
        }

        .img-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block;
            /* Remove espa√ßo extra de inline */
        }

        .no-img {
            color: #ccc;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .img-caption {
            font-size: 8px;
            color: #666;
            text-align: center;
            margin-top: 2mm;
            font-style: italic;
            height: 4mm;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        /* FOOTER SIMPLIFICADO */
        .footer {
            position: absolute;
            bottom: 4mm;
            left: 5mm;
            right: 5mm;
            height: 8mm;
            border-top: 1px solid #ddd;
            padding-top: 2px;
            display: flex;
            justify-content: space-between;
            font-size: 8px;
            background: #fff;
            overflow: hidden;
            color: #777;
        }

        .footer-item {
            flex: 1;
        }

        .footer-label {
            font-size: 8px;
            font-weight: 600;
            text-transform: uppercase;
            color: #666;
        }

        .footer-value {
            font-weight: 600;
            color: #000;
        }

        .footer-right {
            text-align: right;
            font-weight: 600;
        }
    </style>
</head>

<body>

    {{#each items}}
    <div class="ficha">
        <!-- HEADER LIMPO -->
        <div class="header">
            <div class="header-item">
                <span class="h-label">DATA DE ENVIO:</span>
                <span class="h-value">{{data_envio}}</span>
            </div>
            <div class="header-item">
                <span class="h-label">PRIORIDADE:</span>
                <span
                    class="prioridade-tag {{#if (eq prioridade 'Alta')}}prioridade-alta-tag{{else}}{{#if (eq prioridade 'M√©dia')}}prioridade-media-tag{{else}}prioridade-baixa-tag{{/if}}{{/if}}">
                    {{prioridade}}
                </span>
            </div>
            <div class="header-item">
                <span class="h-label">FORMA DE ENVIO:</span>
                <span class="h-value">{{forma_envio}}</span>
            </div>
        </div>

        <!-- CONTE√öDO PRINCIPAL -->
        <div class="main-section">
            <!-- COLUNA ESQUERDA (45%) -->
            <div class="col-left">
                <!-- PEDIDO E CLIENTE -->
                <div class="pedido-box">
                    <div class="pedido-numero">
                        #{{numero}}
                        {{#if is_reposicao}}
                        <span class="badge-reposicao">REPOSI√á√ÉO</span>
                        {{/if}}
                    </div>
                    <div class="cliente-nome">{{cliente}}</div>
                    <div class="cliente-info">{{telefone_cliente}}{{#if cidade_estado}} ‚Ä¢ {{cidade_estado}}{{/if}}</div>
                    <span class="tipo-badge {{tipo_producao}}">{{tipo_producao}}</span>
                </div>

                <div class="left-content">
                    <!-- PRODUTO -->
                    <div class="produto-nome">{{descricao}}</div>

                    <div class="info-grid">
                        <div>
                            <div class="info-label">Dimens√µes</div>
                            <div class="info-value">{{dimensoes}}</div>
                        </div>
                        <div style="text-align: right;">
                            <div class="info-label">Quantidade</div>
                            <div class="info-value qty">{{quantity}}</div>
                        </div>
                    </div>

                    <!-- FICHA T√âCNICA -->
                    <div class="tech-section">
                        <div class="tech-item">
                            <span class="tech-label">Material:</span> {{material}}
                        </div>
                        <div class="tech-item">
                            <span class="tech-label">Emenda:</span> {{emenda_label}}{{#if emenda_qtd}}
                            ({{emenda_qtd}}){{/if}}
                        </div>
                    </div>

                    <!-- ESPECIFICA√á√ïES -->
                    <ul class="specs">
                        {{#if (eq tipo_producao 'painel')}}
                        <li><b>Acabamento:</b> {{acabamentos_painel}}</li>
                        <li><b>Costura:</b> Overloque ({{overloque}}) / El√°stico ({{elastico}})</li>
                        <li><b>Ilh√≥s:</b> {{ilhos_resumo}} | <b>Corda:</b> {{cordinha_resumo}}</li>
                        {{/if}}

                        {{#if (eq tipo_producao 'totem')}}
                        <li><b>Acabamento:</b> {{acabamento_totem_resumo}}</li>
                        {{#if quantidade_totem}}<li><b>Quantidade:</b> {{quantidade_totem}}</li>{{/if}}
                        {{/if}}

                        {{#if (eq tipo_producao 'lona')}}
                        <li><b>Acabamento:</b> {{acabamento_lona}}</li>
                        <li><b>Ilh√≥s:</b> {{quantidade_ilhos}} ({{espaco_ilhos}})</li>
                        {{/if}}

                        {{#if (eq tipo_producao 'adesivo')}}
                        <li><b>Tipo:</b> {{tipo_adesivo}} | <b>Qtd:</b> {{quantidade_adesivo}}</li>
                        {{/if}}
                    </ul>

                    <!-- OBSERVA√á√ïES -->
                    <div class="obs-container">
                        {{#if observacao}}
                        <div class="obs pedido">
                            <div class="obs-title">üìã Obs. Pedido</div>
                            <div>{{observacao}}</div>
                        </div>
                        {{else}}
                        {{#if observacao_pedido}}
                        <div class="obs pedido">
                            <div class="obs-title">üìã Obs. Pedido</div>
                            <div>{{observacao_pedido}}</div>
                        </div>
                        {{/if}}
                        {{/if}}

                        {{#if observacao_item}}
                        <div class="obs">
                            <div class="obs-title">‚ö†Ô∏è Obs. Produ√ß√£o</div>
                            <div>{{observacao_item}}</div>
                        </div>
                        {{/if}}
                    </div>
                </div>
            </div>

            <!-- COLUNA DIREITA - IMAGEM (55%) -->
            <div class="col-right">
                <div class="img-title">Visualiza√ß√£o da Arte</div>
                <div class="img-box">
                    {{#if imagem}}
                    <img src="{{imagem}}" alt="Arte"
                        onerror="this.style.display='none'; this.parentNode.innerHTML='<span class=\'no-img\'>SEM IMAGEM</span>';">
                    {{else}}
                    <span class="no-img">SEM PR√âVIA</span>
                    {{/if}}
                </div>
                {{#if legenda_imagem}}
                <div class="img-caption">{{legenda_imagem}}</div>
                {{/if}}
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <div class="footer-item">
                <div class="footer-label">Designer</div>
                <div class="footer-value">{{designer}}</div>
            </div>
            <div class="footer-item">
                <div class="footer-label">Vendedor</div>
                <div class="footer-value">{{vendedor}}</div>
            </div>
            <div class="footer-item footer-right">
                <div class="footer-label">Controle de Produ√ß√£o</div>
                <div>RIP: _______ DATA: __/__/__</div>
            </div>
        </div>
    </div>
    {{/each}}

</body>

</html>
